<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org" xmlns:c="http://java.sun.com/jsp/jstl/core">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚úàReserva - ${param.destino} üèñ</title>
    <link rel="stylesheet" type="text/css" href="/css/style.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
</head>

<body id="reserva"
    style="background: url('/img/fundo.jpg') no-repeat center center fixed; background-size: cover;">

    <header>
        <nav id="header"></nav>
    </header>

    <main class="hidden mt-4">
        <div class="container">
            <h1 class="text-center mb-8 page-title">Confirma√ß√£o de Reserva</h1>
            <div class="text-center alert alert-warning" role="alert">
                <h2>Aten√ß√£o: sua reserva est√° garantida por 2 (dois) dias √∫teis!</h2>

                <p>Envie um e-mail para reservas@bedinviagens.com.br para combinar a forma de pagamento.</p>

                <p>Agradecemos por escolher nossos servi√ßos.</p>
                <a href="index.jsp" class="btn btn-primary">Voltar √† P√°gina Inicial</a>
                <button type="button" id="btnListarReservas" class="btn btn-secondary">Listar Reservas</button>
            </div>
        </div>
        <div class="container">
            <h3 class="text-center mb-8 page-title">Lista de Reservas</h3>
            <div class="table-responsive">
                <table id="tabelaReservas" class="table table-sm">
                    <thead>
                        <tr>
                            <th>ID Reserva</th>
                            <th>Nome do Cliente</th>
                            <th>RG</th>
                            <th>CPF</th>
                            <th>Data de Nascimento</th>
                            <th>Email</th>
                            <th>Celular</th>
                            <th>Destino do Pacote</th>
                            <th>Data de Partida</th>
                            <th>Data de Retorno</th>
                            <th>Nome do Hotel</th>
                            <th>Valor</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="reserva : ${listarReservas}">
                            <td th:text="${reserva.id}"></td>
                            <td th:text="${reserva.cliente.nome}"></td>
                            <td th:text="${reserva.cliente.rg}"></td>
                            <td th:text="${reserva.cliente.cpf}"></td>
                            <td th:text="${reserva.cliente.dataNascimento}"></td>
                            <td th:text="${reserva.cliente.email}"></td>
                            <td th:text="${reserva.cliente.celular}"></td>
                            <td th:text="${reserva.pacote.destino}"></td>
                            <td th:text="${reserva.pacote.dataPartida}"></td>
                            <td th:text="${reserva.pacote.dataRetorno}"></td>
                            <td th:text="${reserva.pacote.nomeHotel}"></td>
                            <td th:text="${reserva.pacote.valor}"></td>
                            <td>
                                <a th:href="@{'/AlterarReservaid=' + ${reserva.id}}"
                                    class="btn btn-success">Editar</a>
                                <a th:href="@{'ExcluirReserva?id=' + ${reserva.id}}"
                                    onclick="return confirm('Deseja Excluir?')" class="btn btn-danger">Excluir</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <footer></footer>

    <script th:inline="javascript">
        document.getElementById('btnListarReservas').addEventListener('click', function () {
            // Cria um objeto XMLHttpRequest
            var xhr = new XMLHttpRequest();

            // Configura a requisi√ß√£o
            xhr.open('GET',  /*[[@{/ListarReserva}]]*/ '', true);

            // Configura a fun√ß√£o a ser chamada quando a requisi√ß√£o for completada com sucesso
            xhr.onload = function () {
                if (xhr.status >= 200 && xhr.status < 400) {
                    // A requisi√ß√£o foi bem-sucedida, atualiza a tabela com os dados recebidos
                    var tableBody = document.querySelector('#tabelaReservas tbody');
                    tableBody.innerHTML = xhr.responseText;
                } else {
                    // Houve um erro na requisi√ß√£o
                    console.error('Erro na requisi√ß√£o: ' + xhr.statusText);
                }
            };

            // Configura a fun√ß√£o a ser chamada em caso de erro
            xhr.onerror = function () {
                console.error('Erro na requisi√ß√£o.');
            };

            // Envia a requisi√ß√£o
            xhr.send();
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/scripts/function.js"></script>
    <script src="/scripts/components.js"></script>
</body>

</html>
